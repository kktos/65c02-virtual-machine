10 S = 4 : REM SLOT 4
20 B = 49152 + (S * 256) : REM BASE ADDRESS $C400
30 ORB = B : ORA = B + 1
40 DDRB = B + 2 : DDRA = B + 3
50 REM INIT VIA PORTS TO OUTPUT
60 POKE DDRB, 255 : POKE DDRA, 255
70 REM RESET AY CHIP (RESET LOW THEN HIGH)
80 POKE ORB, 0 : POKE ORB, 4
90 REM ENABLE TONE A (MIXER REG 7 = 62/0x3E)
100 R=7 : V=62 : GOSUB 1000
110 REM SET MAX VOLUME A (REG 8 = 15)
120 R=8 : V=15 : GOSUB 1000
130 REM SET COARSE TUNE A (REG 1 = 0)
140 R=1 : V=0 : GOSUB 1000
150 REM SWEEP FINE TUNE A (REG 0)
160 FOR I = 0 TO 255
170 R=0 : V=I : GOSUB 1000
180 NEXT I
190 GOTO 160
999 END
1000 REM SUBROUTINE: WRITE REGISTER R WITH VALUE V
1010 POKE ORA, R
1020 POKE ORB, 7 : POKE ORB, 4 : REM LATCH ADDRESS
1030 POKE ORA, V
1040 POKE ORB, 6 : POKE ORB, 4 : REM WRITE DATA
1050 RETURN
